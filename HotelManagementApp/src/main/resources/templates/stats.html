<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Thá»‘ng kÃª - Hotel Management</title>
    <th:block th:replace="base :: head"></th:block>
</head>
<body>
    <div th:replace="base :: layout(~{::content})">
        <div th:fragment="content">
            <div class="container mt-4">
                <h2 class="mb-4">ðŸ“Š Thá»‘ng kÃª doanh thu</h2>

                <!-- Tá»•ng doanh thu -->
                <div class="alert alert-success fs-5">
                    Tá»•ng doanh thu:
                    <strong th:text="${#numbers.formatDecimal(totalRevenue, 0, 'COMMA', 0, 'POINT')} + ' VND'"></strong>
                </div>

                <!-- Báº£ng doanh thu theo thÃ¡ng -->
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>ThÃ¡ng</th>
                            <th>Doanh thu (VND)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="entry : ${revenueByMonth}">
                            <td th:text="${entry.key}"></td>
                            <td th:text="${#numbers.formatDecimal(entry.value, 0, 'COMMA', 0, 'POINT')}"></td>
                        </tr>
                    </tbody>
                </table>

                <canvas id="revenueChart" height="120"></canvas>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        /*<![CDATA[*/
        // Láº¥y dá»¯ liá»‡u JSON tá»« backend
        const revenueByMonth = JSON.parse(/*[[${revenueByMonthJson}]]*/ '{}');

        const labels = Object.keys(revenueByMonth).map(m => "ThÃ¡ng " + m);
        const data = Object.values(revenueByMonth);

        new Chart(document.getElementById('revenueChart'), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                        label: 'Doanh thu (VND)',
                        data: data,
                        backgroundColor: 'rgba(54, 162, 235, 0.7)'
                    }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {beginAtZero: true}
                }
            }
        });
        /*]]>*/
    </script>
</body>
</html>
